# Version de docker-composer souhait√©e
version : "3.7"

services :

    app_symfony :
        build : ./
        ports :
            - 8080:80
        volumes :
            - ./:/var/www/html
        tty: true
        networks:
            - frontend
            - backend
        #links :
        #    - bdd:bdd
        environment:
            MYSQL_HOST : bdd
            MYSQL_DATABASE: app_symfony
            MYSQL_USER : root
            MYSQL_PASSWORD : root

    composer :
        image : composer:latest
        ports :
            - 8081:80
        networks:
            - backend
       # links :
       #     - php_apache:php_apache
        volumes :
            - hotfolder_composer:/usr/bin/

    #integration :
    #    build : ./docker/jenkins
    #    ports :
    #       - 8084:8080
    #       - 50000:50000
    #    volumes :
    #       - hotfolder_jenkins:/var/jenkins_home   
    #    links :
    #       - php_apache

    bdd :
        build : ./docker/mariadb
        restart : unless-stopped
        ports :
            - 3306:3306
        labels:
            com.symfony.server.service-prefix: 'DATABASE'
        volumes :
            - hotfolder_bdd:/var/lib/mysql
        networks:
            - backend
        environment :
            MYSQL_ROOT_USER : symfony
            MYSQL_ROOT_PASSWORD : symfony
        tty: true

    phpMyAdmin :
        image : phpmyadmin/phpmyadmin:5.0
        ports :
            - 8082:80
       # links :
       #     - bdd:bdd
        environment :
            - PMA_HOST=bdd
        networks:
            - backend
            
networks:
  frontend:
    driver: bridge         
  backend:
    driver: bridge
    
volumes:
    hotfolder_bdd:
    hotfolder_composer:
    hotfolder_jenkins: